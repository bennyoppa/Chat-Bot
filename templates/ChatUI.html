<!DOCTYPE html>
<html lang="zh">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>CHAT_BOT</title>
    {% load static %}
	<link rel="stylesheet" type="text/css" href="{% static "normalize.css" %}" />
	<link rel="stylesheet" type="text/css" href="{% static "htmleaf-demo.css"%}"/>
	<link rel="stylesheet" href="{% static "botui.min.css" %}"/>
    <link rel="stylesheet" href="{% static "botui-theme-default.css"%}" />
</head>
<body id="mybody">
{% csrf_token %}

			<div class="botui-app-container" id="mychatbotUI" >
			      <bot-ui></bot-ui>
			</div>
    <script type="text/javascript" src="http://code.jquery.com/jquery-latest.js"></script>
	<script src="{% static "botui.min.js"%}"></script>
    <script src="{% static "vue.min.js"%}"></script>
	<script type="text/javascript">
		var homeBot = BotUI('mychatbotUI');
		homeBot.message.add({
          delay: 1000,
		  content: 'ü§ñ:Hi, my name is Uri. I\'m an intelligent chatting bot. I can answer CSE course enrolment related questions.'
		}).then(function (res) {
		      loopfuc3();

		  if(res.value == 'skip') {
		    end();
		  }
		});

		var mytutorial = function () {
		    homeBot.message.add({
		    delay: 1000,
		    content: "ü§ñ: cool, try to ask me some course information about cse"
		  }).then(function () {
		      homeBot.message.add({
		      delay: 1000,
		      content: 'ü§ñ: like which course you want to know more about itÔºüÔºàhit enter after type in..Ôºâ'
		    });
        })}

		  var loopfuc3=function () {
              return homeBot.action.text({
		      delay:1000,
		      action: {
		        value: '',
		        placeholder: 'üë®‚Äçüéì  type in please...'
		      }
		  }).then(function (res) {
		      var data = JSON.stringify({"content":res.value})
              $.ajax({
                url:"Chatbot_sub",
                contentType:'application/json;charset=UTF-8',
                type:"POST",
                data:data,
                beforeSend: function(xhr, settings) {
                    var token =  $('input[name=csrfmiddlewaretoken]').val()
                    xhr.setRequestHeader("X-CSRFToken",token);
                },
                success:
                    function (data) {
                     console.log(data)
                      return homeBot.message.add({
                      delay: 0,
		              content: 'ü§ñ:'+data
		         }).then(function () {
                        loopfuc3();
                      });
                 },error:function (error) {
                    console.log(error)
                }
            })
		  });
          }

		var end = function () {
		  homeBot.message.add({
		    delay: 1000,
		    content: 'see ya!'
		  });
		};
	</script>
<style>
html { overflow-y:hidden; }
</style>
</body>
</html>